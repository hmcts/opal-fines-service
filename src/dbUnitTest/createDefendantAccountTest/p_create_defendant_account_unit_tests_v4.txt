Timing is on.
psql:p_create_defendant_account_unit_tests_v4.sql:73: NOTICE:  === Cleanup data before tests ===
psql:p_create_defendant_account_unit_tests_v4.sql:73: NOTICE:  Data cleanup before tests completed
DO
Time: 12.859 ms
psql:p_create_defendant_account_unit_tests_v4.sql:295: NOTICE:  === TEST 1: Basic account creation with minimum required fields ===
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000001E, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_defendant_account: defendant_account_id: 60000000000000. Generated account number: 25000001E
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000000, party_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000000, party_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_fp_offences: There were no FP ticket details to process for defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_impositions: defendant_transactions has been updated. defendant_transaction_id = 60000000000000, transaction_amount = 50.00
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_payment_terms: Created payment_terms record for defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_payment_terms: defendant_accounts.jail_days [<NULL>] has been updated. defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_enforcements: There were no enforcements to process for defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_account_notes: There were no account notes to process for defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_defendant_account: Created document_instances records for defendant_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:295: INFO:  p_create_defendant_account: Created report_entries record for defendant_account_id = 60000000000000, report_id = tfo_in_register
psql:p_create_defendant_account_unit_tests_v4.sql:295: NOTICE:  TEST 1 PASSED: Created account 25000001E with ID 60000000000000
DO
Time: 31.548 ms
psql:p_create_defendant_account_unit_tests_v4.sql:533: NOTICE:  === TEST 2: Basic account creation with minimum required fields and account_type = "Fixed Penalty", payment_terms "B" with effective_date = NULL and jail_days
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_account_type                = Fixed Penalty
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000002A, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_defendant_account: defendant_account_id: 60000000000001. Generated account number: 25000002A
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000001, party_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000001, party_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_impositions: defendant_transactions has been updated. defendant_transaction_id = 60000000000001, transaction_amount = 50.00
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_payment_terms: Created payment_terms record for defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_payment_terms: defendant_accounts.jail_days [14] has been updated. defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_enforcements: There were no enforcements to process for defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_account_notes: There were no account notes to process for defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_defendant_account: Created document_instances records for defendant_account_id = 60000000000001
psql:p_create_defendant_account_unit_tests_v4.sql:533: INFO:  p_create_defendant_account: Created report_entries record for defendant_account_id = 60000000000001, report_id = fp_register
psql:p_create_defendant_account_unit_tests_v4.sql:533: NOTICE:  TEST 2 PASSED: Created account 25000002A with ID 60000000000001
DO
Time: 5.685 ms
psql:p_create_defendant_account_unit_tests_v4.sql:1522: NOTICE:  === TEST 3: Full account creation with all fields including payment card request - account_type = "Fixed Penalty", debtor is the parent/guardian ===
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_account_type                = Fixed Penalty
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_defendant_type              = pgToPay
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000003T, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_account: defendant_account_id: 60000000000002. Generated account number: 25000003T
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000002, party_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000002, party_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_aliases: Created aliases for party_id = 60000000000002 - Alias count = 2
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_parties: Created parties record for the parent_guardian. defendant_account_id = 60000000000002, party_id = 60000000000003
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the parent_guardian. defendant_account_id = 60000000000002, party_id = 60000000000003
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000003
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_aliases: Created aliases for party_id = 60000000000003 - Alias count = 1
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_minor_creditor: Created parties record for the minor_creditor. party_id = 60000000000004
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000004P, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_minor_creditor: Created creditor_accounts record for the minor_creditor. creditor_account_id = 60000000000000
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_get_creditor_account: Created creditor_account_id = 60000000000000 - result_id = FCOMP, imposition_creditor = Any
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_impositions: Processed 1 offences, 2 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_impositions: defendant_transactions has been updated. defendant_transaction_id = 60000000000002, transaction_amount = 40.00
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_payment_terms: Created payment_terms record for defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_payment_terms: defendant_accounts.jail_days [14] has been updated. defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_enforcements: last enforcement result ID = NOENF
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_enforcements: Inserted 3 enforcements records for defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_enforcements: defendant_accounts.last_enforcement [NOENF] has been updated. defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_account_notes: Inserted 2 AA notes records, out of 3, for defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_account_notes: defendant_accounts has been updated with account comments. defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_account: Created document_instances records for defendant_account_id = 60000000000002
psql:p_create_defendant_account_unit_tests_v4.sql:1522: INFO:  p_create_defendant_account: Created report_entries record for defendant_account_id = 60000000000002, report_id = fp_register
psql:p_create_defendant_account_unit_tests_v4.sql:1522: NOTICE:  TEST 3 PASSED: Created account 25000003T with ID 60000000000002 and payment card request
DO
Time: 22.895 ms
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  === TEST 4: Test handling of missing required fields ===
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_account_type                = <NULL>
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_defendant_type              = <NULL>
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_account_sentence_date       = <NULL>
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:1602: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  Error in p_create_defendant_account: 23502 - null value in column "account_type" of relation "defendant_accounts" violates not-null constraint
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  Error details: Failing row contains (60000000000003, 65, 25000005L, null, null, 0.00, 0.00, 0.00, L, null, 650000000045, null, null, 2025-10-17 14:22:51.400874, null, null, LJS, TFO, t, t, 10, 0, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 12345, null, null, null, null, null, null, 1, null).
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  Expected error caught: Error in p_create_defendant_account: 23502 - null value in column "account_type" of relation "defendant_accounts" violates not-null constraint
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:1602: NOTICE:  TEST 4 PASSED: Error handling works correctly for missing required fields
DO
Time: 1.008 ms
psql:p_create_defendant_account_unit_tests_v4.sql:1719: NOTICE:  === TEST 5: Test handling da_account_type_cc check constraint violation ===
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_account_type                = fine
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:1719: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000001E, BU: 60
psql:p_create_defendant_account_unit_tests_v4.sql:1719: NOTICE:  Error in p_create_defendant_account: 23514 - new row for relation "defendant_accounts" violates check constraint "da_account_type_cc"
psql:p_create_defendant_account_unit_tests_v4.sql:1719: NOTICE:  Error details: Failing row contains (60000000000004, 60, 25000001E, 2024-12-12 00:00:00, null, 0.00, 0.00, 0.00, L, null, 650000000045, null, null, 2025-10-17 14:22:51.402238, null, null, LJS, FP, t, t, 10, 0, null, null, null, null, null, null, null, null, null, null, null, null, t, 2025-10-17 14:22:51.402238, L045EO, null, null, 12345, fine, null, null, null, null, null, 1, Tester 1).
psql:p_create_defendant_account_unit_tests_v4.sql:1719: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:1719: NOTICE:  TEST 5 PASSED: Error handling works correctly for da_account_type_cc check constraint violation.
DO
Time: 1.442 ms
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  === TEST 6: Test handling when defendant_type = "pgToPay" AND parent_guardian Json is missing = P2002 ===
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_defendant_type              = pgToPay
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  p_create_defendant_account: defendant_account_id: 60000000000005. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000005, party_id = 60000000000005
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000005, party_id = 60000000000005
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000005
psql:p_create_defendant_account_unit_tests_v4.sql:1860: INFO:  p_create_aliases: Created aliases for party_id = 60000000000005 - Alias count = 2
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  Error in p_create_defendant_parties: P2002 - Missing parent/guardian
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  Error in p_create_defendant_account: P2002 - Missing parent/guardian
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  Expected error caught: P2002 - Missing parent/guardian
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:1860: NOTICE:  TEST 6 PASSED: Error handling works correctly for missing parent_guardian details
DO
Time: 1.838 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  === TEST 7: Test handling when account_type = "Fixed Penalty" but notice_number field is missing (Json null) = P2011 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_account_type                = Fixed Penalty
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  p_create_defendant_account: defendant_account_id: 60000000000006. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000006, party_id = 60000000000006
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000006, party_id = 60000000000006
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000006
psql:p_create_defendant_account_unit_tests_v4.sql:2011: INFO:  p_create_aliases: Created aliases for party_id = 60000000000006 - Alias count = 2
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  Error in p_create_fp_offences: P2011 - Missing ticket number
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  Error in p_create_defendant_account: P2011 - Missing ticket number
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  Expected error caught: P2011 - Missing ticket number
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2011: NOTICE:  TEST 7 PASSED: Error handling works correctly for missing notice_number field
DO
Time: 1.499 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  === TEST 8A: Test handling when the passed payment terms are invalid = P2003 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  ===          When payment_terms_type_code is not B, I or P                   ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_account: defendant_account_id: 60000000000007. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000007, party_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000007, party_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000007
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_payment_terms: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_defendant_account: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8A: Expected error caught: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8A: ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  TEST 8A PASSED: Error handling works correctly when the passed payment terms are invalid
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  === TEST 8B: Test handling when the passed payment terms are invalid = P2003                           ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  ===    When payment_terms_type_code = B, effective_date IS NOT NULL, account_type is NOT Fixed Penalty ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_account: defendant_account_id: 60000000000008. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000008, party_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000008, party_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000008
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_payment_terms: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_defendant_account: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8B: Expected error caught: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8B: ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  TEST 8B PASSED: Error handling works correctly when the passed payment terms are invalid
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  === TEST 8C: Test handling when the passed payment terms are invalid = P2003                         ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  ===    When payment_terms_type_code = I, effective_date IS NOT NULL but instalment_amount is missing ===
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_account: defendant_account_id: 60000000000009. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000009, party_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000009, party_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:2314: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000009
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_payment_terms: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Error in p_create_defendant_account: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8C: Expected error caught: P2003 - Invalid payment terms
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  Test 8C: ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2314: NOTICE:  TEST 8C PASSED: Error handling works correctly when the passed payment terms are invalid
DO
Time: 4.796 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  === TEST 9: Test handling when the passed imposition result ID is invalid = P2004 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_defendant_account: defendant_account_id: 60000000000010. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000010, party_id = 60000000000010
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000010, party_id = 60000000000010
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000010
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000010
psql:p_create_defendant_account_unit_tests_v4.sql:2469: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000010
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  Error in p_get_creditor_account: P2004 - Result ZZZZZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  Error in p_create_impositions: P2004 - Result ZZZZZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  Error in p_create_defendant_account: P2004 - Result ZZZZZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  Expected error caught: P2004 - Result ZZZZZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2469: NOTICE:  TEST 9 PASSED: Error handling works correctly when the passed imposition result ID is invalid
DO
Time: 1.562 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  === TEST 10: Test handling when the passed creditor information is missing = P2005 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_defendant_account: defendant_account_id: 60000000000011. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000011, party_id = 60000000000011
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000011, party_id = 60000000000011
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000011
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000011
psql:p_create_defendant_account_unit_tests_v4.sql:2624: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000011
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  Error in p_get_creditor_account: P2005 - Missing creditor
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  Error in p_create_impositions: P2005 - Missing creditor
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  Error in p_create_defendant_account: P2005 - Missing creditor
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  Expected error caught: P2005 - Missing creditor
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2624: NOTICE:  TEST 10 PASSED: Error handling works correctly when the passed creditor information is missing
DO
Time: 2.044 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  === TEST 11: Test handling when the passed major_creditor_id cannot be found = P2006 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_defendant_account: defendant_account_id: 60000000000012. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000012, party_id = 60000000000012
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000012, party_id = 60000000000012
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000012
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000012
psql:p_create_defendant_account_unit_tests_v4.sql:2779: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000012
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  Error in p_get_creditor_account: P2006 - Creditor 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  Error in p_create_impositions: P2006 - Creditor 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  Error in p_create_defendant_account: P2006 - Creditor 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  Expected error caught: P2006 - Creditor 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2779: NOTICE:  TEST 11 PASSED: Error handling works correctly when the passed major_creditor_id cannot be found
DO
Time: 1.449 ms
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  === TEST 12: Test handling when the passed enforcement court cannot be found = P2007 ===
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_enforcement_court_id        = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:2934: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  Error in p_create_defendant_account: 23503 - insert or update on table "defendant_accounts" violates foreign key constraint "da_enforcing_court_id_fk"
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  Error details: Key (enforcing_court_id)=(0) is not present in table "courts".
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  Expected error caught: P2007 - Enforcement court 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:2934: NOTICE:  TEST 12 PASSED: Error handling works correctly when the passed enforcement court cannot be found
DO
Time: 1.070 ms
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  === TEST 13: Test handling when the passed imposing court is not found = P2008 ===
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_defendant_account: defendant_account_id: 60000000000014. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000014, party_id = 60000000000013
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000014, party_id = 60000000000013
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000013
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000013
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000014
psql:p_create_defendant_account_unit_tests_v4.sql:3088: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  Error in p_create_impositions: 23503 - insert or update on table "impositions" violates foreign key constraint "imp_imposing_court_id_fk"
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  Error details: Key (imposing_court_id)=(0) is not present in table "courts".
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  Error in p_create_defendant_account: P2008 - Imposing court '0' not found
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  Expected error caught: P2008 - Imposing court '0' not found
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:3088: NOTICE:  TEST 13 PASSED: Error handling works correctly when imposing court is not found
DO
Time: 1.481 ms
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  === TEST 14: Test handling when the passed offence cannot be found = P2009 ===
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_defendant_account: defendant_account_id: 60000000000015. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000015, party_id = 60000000000014
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000015, party_id = 60000000000014
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000014
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000014
psql:p_create_defendant_account_unit_tests_v4.sql:3243: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000015
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  Error in p_create_impositions: P2009 - Offence 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  Error in p_create_defendant_account: P2009 - Offence 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  Expected error caught: P2009 - Offence 0 not found
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:3243: NOTICE:  TEST 14 PASSED: Error handling works correctly when the passed offence cannot be found
DO
Time: 1.324 ms
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  === TEST 15: Test handling when the passed minor creditor bank details are missing = P2010 ===
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_defendant_account: defendant_account_id: 60000000000016. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000016, party_id = 60000000000015
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000016, party_id = 60000000000015
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000015
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000015
psql:p_create_defendant_account_unit_tests_v4.sql:3416: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000016
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  Error in p_create_minor_creditor: P2010 - Missing bank detail
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  Error in p_get_creditor_account: P2010 - Missing bank detail
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  Error in p_create_impositions: P2010 - Missing bank detail
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  Error in p_create_defendant_account: P2010 - Missing bank detail
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  Expected error caught: P2010 - Missing bank detail
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:3416: NOTICE:  TEST 15 PASSED: Error handling works correctly when the passed minor creditor bank details are missing
DO
Time: 1.608 ms
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  === TEST 16: Test handling when the passed Notes Json contains an invalid note_type = P2012 ===
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_defendant_account: defendant_account_id: 60000000000017. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000017, party_id = 60000000000016
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000017, party_id = 60000000000016
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000016
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000016
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_impositions: defendant_transactions has been updated. defendant_transaction_id = 60000000000003, transaction_amount = 40.00
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_payment_terms: Created payment_terms record for defendant_account_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_payment_terms: defendant_accounts.jail_days [14] has been updated. defendant_account_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3641: INFO:  p_create_enforcements: There were no enforcements to process for defendant_account_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  Error in p_create_account_notes: P2012 - Note_type ZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  Error in p_create_defendant_account: P2012 - Note_type ZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  Expected error caught: P2012 - Note_type ZZ is not valid
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:3641: NOTICE:  TEST 16 PASSED: Error handling works correctly when the passed Notes Json contains an invalid note_type
DO
Time: 2.273 ms
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  === TEST 17: Test handling when the passed Notes Json contains more than 1 AC entries = P2013 ===
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_account_type                = Fine
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_defendant_type              = adultOrYouthOnly
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_account_sentence_date       = 2024-12-12 00:00:00
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_enforcement_court_id        = 650000000045
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_originator_name             = LJS
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  v_originator_id               = 12345
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  Inserting record into ACCOUNT_NUMBER_INDEX for account_number: 25000005L, BU: 65
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_defendant_account: defendant_account_id: 60000000000018. Generated account number: 25000005L
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_defendant_parties: Created parties record for the defendant. defendant_account_id = 60000000000018, party_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_defendant_parties: Created defendant_account_parties record for the defendant. defendant_account_id = 60000000000018, party_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_debtor_details: Created debtor_detail record for party_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_aliases: There were no aliases to process for party_id = 60000000000017
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_fp_offences: Created fixed_penalty_offences record for defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_get_creditor_account: Found creditor_account_id = 65 - result_id = FO, imposition_creditor = CF
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_impositions: Processed 1 offences, 1 impositions
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_impositions: defendant_transactions has been updated. defendant_transaction_id = 60000000000004, transaction_amount = 40.00
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_impositions: defendant_accounts has been updated. defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_payment_terms: Created payment_terms record for defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_payment_terms: defendant_accounts.jail_days [14] has been updated. defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_enforcements: There were no enforcements to process for defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: INFO:  p_create_account_notes: Inserted 2 AA notes records, out of 3, for defendant_account_id = 60000000000018
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  Error in p_create_account_notes: P2013 - Only one AC note type is expected. Number of AC entries = 2
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  Error in p_create_defendant_account: P2013 - Only one AC note type is expected. Number of AC entries = 2
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  Expected error caught: P2013 - Only one AC note type is expected. Number of AC entries = 2
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  ACCOUNT_NUMBER_INDEX row count = 0
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  TEST 17 PASSED: Error handling works correctly when the passed Notes Json contains more than 1 AC entries
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  === All tests completed and passed for p_create_defendant_account ===
psql:p_create_defendant_account_unit_tests_v4.sql:3873: NOTICE:  === All tests completed and passed for p_create_defendant_account ===
DO
Time: 2.200 ms
Timing is off.
