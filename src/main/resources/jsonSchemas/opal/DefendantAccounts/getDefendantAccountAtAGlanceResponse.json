{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Defendant Account At A Glance",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "defendant_account_id": { "type": "string" },
    "version": { "type": "integer" },
    "account_number": { "type": "string" },
    "defendant_party_id": { "type": "string" },
    "parent_guardian_party_id": { "type": ["string", "null"] },
    "debtor_detail": {
      "type": "object",
      "properties": {
        "debtor_type": {
          "type": "string",
          "enum": ["Defendant", "Parent/Guardian"]
        },
        "organisation": { "type": "boolean" },
        "aliases": {
          "type": ["array", "null"],
          "maxItems": 5,
          "items": {
            "type": "object",
            "properties": {
              "alias_id": { "type": "integer" },
              "sequence_number": {
                "type": "integer",
                "minimum": 1,
                "maximum": 5
              },
              "organisation_name": { "type": ["string", "null"] },
              "surname": { "type": ["string", "null"] },
              "forenames": { "type": ["string", "null"] }
            },
            "required": ["alias_id", "sequence_number"]
          }
        },
        "address_line_1": { "type": "string" },
        "address_line_2": { "type": ["string", "null"] },
        "address_line_3": { "type": ["string", "null"] },
        "address_line_4": { "type": ["string", "null"] },
        "address_line_5": { "type": ["string", "null"] },
        "post_code": { "type": "string" },
        "document_language": { "type": "string" },
        "hearing_language": { "type": "string" },
        "organisation_name": { "type": ["string", "null"] },
        "title": { "type": ["string", "null"] },
        "first_names": { "type": ["string", "null"] },
        "surname": { "type": ["string", "null"] },
        "date_of_birth": { "type": ["string", "null"], "format": "date" },
        "national_insurance_number": { "type": ["string", "null"] }
      },
      "required": [
        "debtor_type",
        "organisation",
        "address_line_1",
        "post_code",
        "document_language",
        "hearing_language"
      ],
      "allOf": [
        {
          "if": { "properties": { "organisation": { "const": true } } },
          "then": { "required": ["organisation_name"] },
          "else": {
            "required": ["title", "first_names", "surname", "date_of_birth"]
          }
        }
      ]
    },
    "payment_terms": {
      "type": "object",
      "properties": {
        "payment_terms_summary": { "type": ["string", "null"] },
        "payment_terms_type_code": {
          "type": "string",
          "enum": ["B", "P", "I"]
        },
        "effective_date": { "type": ["string", "null"], "format": "date" },
        "instalment_period": {
          "type": ["string", "null"],
          "enum": ["W", "M", "F"]
        },
        "lump_sum_amount": {
          "type": ["number", "null"],
          "multipleOf": 0.01
        },
        "instalment_amount": {
          "type": ["number", "null"],
          "multipleOf": 0.01
        },
        "last_payment_date": { "type": ["string", "null"], "format": "date" },
        "next_payment_date": { "type": ["string", "null"], "format": "date" }
      },
      "required": ["payment_terms_type_code"]
    },
    "enforcement_status": {
      "type": "object",
      "properties": {
        "last_enforcement_action": { "type": ["string", "null"] },
        "last_enforcement_action_title": { "type": ["string", "null"] },
        "collection_order_made": { "type": "boolean" },
        "default_days_in_jail": { "type": ["integer", "null"] },
        "enforcement_override_id": { "type": ["string", "null"] },
        "enforcement_override_title": { "type": ["string", "null"] },
        "last_movement_date": { "type": ["string", "null"], "format": "date" }
      },
      "required": ["collection_order_made"]
    },
    "account_notes": {
      "type": ["array", "null"],
      "items": {
        "type": "object",
        "properties": {
          "account_comment": { "type": "string" },
          "free_text_note_1": { "type": "string" },
          "free_text_note_2": { "type": "string" },
          "free_text_note_3": { "type": "string" }
        },
        "required": [
          "account_comment",
          "free_text_note_1",
          "free_text_note_2",
          "free_text_note_3"
        ]
      }
    }
  },
  "required": [
    "defendant_account_id",
    "version",
    "account_number",
    "defendant_party_id",
    "debtor_detail",
    "payment_terms",
    "enforcement_status"
  ]
}
